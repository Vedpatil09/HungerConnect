<!DOCTYPE html>
<html>
<head>
  <title>Login | FoodShare</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body class="auth-body">

  <div class="auth-card">

    <!-- App Name -->
    <h1 class="auth-logo">HungerConnectüçî</h1>
    <h2>Welcome Back</h2>

    <!-- Error Message -->
    <div id="errorBox" class="error-popup" style="display:none;"></div>

    <!-- Login Box -->
    <div class="login-box">

      <input
        type="email"
        id="email"
        placeholder="Email address"
        required
      >

      <input
        type="password"
        id="password"
        placeholder="Password"
        required
      >

      <button id="loginBtn">
        Login
      </button>

    </div>

    <p class="auth-footer">
      New here?
      <a href="/register">Create account</a>
    </p>

  </div>

<script>
const btn = document.getElementById("loginBtn");
const errorBox = document.getElementById("errorBox");

btn.addEventListener("click", async () => {

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  if (!email || !password) {
    showError("Please fill all fields");
    return;
  }

  try {

    const res = await fetch("/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      credentials: "include",
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();

    if (data.success) {
      window.location.href = "/home";
    } else {
      showError(data.error || "Login failed");
    }

  } catch (err) {
    showError("Server error");
  }

});

function showError(msg) {
  errorBox.innerText = msg;
  errorBox.style.display = "block";
}
</script>

</body>
</html>